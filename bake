#!/usr/bin/env bash

DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" >/dev/null 2>&1 && pwd )"

usage="bake -b <bookname> -i <inputfile> -r <resourcedir> -o <outputfile>"

# Get command line arguments

while getopts b:i:o:r:h flag
do
  case "${flag}" in
    b) book=${OPTARG} ;;
    i) input_file=${OPTARG} ;;
    r) resource_dir=${OPTARG} ;;
    o) output_file=${OPTARG} ;;
    h) echo $usage; exit 0 ;;
    *) echo "Unknown flag '${flag}'"; exit 1 ;;
  esac
done

# Call the baking script based on the book; books will probably have the same
# calling syntax, but maybe not so don't try to reduce duplication here.

DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" >/dev/null 2>&1 && pwd )"

case "${book}" in
  accounting) $DIR/lib/recipes/accounting/bake --input $input_file --output $output_file --resources $resource_dir;;
  american-government) $DIR/lib/recipes/american-government/bake --input $input_file --output $output_file;;
  anatomy) $DIR/lib/recipes/anatomy/bake --input $input_file --output $output_file;;
  anthropology) $DIR/lib/recipes/anthropology/bake --input $input_file --output $output_file;;
  ap-biology) $DIR/lib/recipes/ap-biology/bake --input $input_file --output $output_file;;
  ap-history) $DIR/lib/recipes/ap-history/bake --input $input_file --output $output_file;;
  ap-physics) $DIR/lib/recipes/ap-physics/bake --input $input_file --output $output_file;;
  ap-physics-2e) $DIR/lib/recipes/ap-physics-2e/bake --input $input_file --output $output_file;;
  astronomy) $DIR/lib/recipes/astronomy/bake --input $input_file --output $output_file;;
  bca) $DIR/lib/recipes/bca/bake --input $input_file --output $output_file;;
  biology) $DIR/lib/recipes/biology/bake --input $input_file --output $output_file;;
  business-ethics) $DIR/lib/recipes/business-ethics/bake --input $input_file --output $output_file;;
  calculus) $DIR/lib/recipes/calculus/bake --input $input_file --output $output_file;;
  chemistry) $DIR/lib/recipes/chemistry/bake --input $input_file --output $output_file;;
  college-physics) $DIR/lib/recipes/college-physics/bake --input $input_file --output $output_file;;
  college-physics-2e) $DIR/lib/recipes/college-physics-2e/bake --input $input_file --output $output_file;;
  college-success) $DIR/lib/recipes/college-success/bake --input $input_file --output $output_file;;
  computer-science) $DIR/lib/recipes/computer-science/bake --input $input_file --output $output_file;;
  contemporary-math) $DIR/lib/recipes/contemporary-math/bake --input $input_file --output $output_file;;
  dev-math) $DIR/lib/recipes/dev-math/bake --input $input_file --output $output_file;;
  dummy) $DIR/lib/recipes/dummy/bake --input $input_file --output $output_file --resources $resource_dir;;
  economics) $DIR/lib/recipes/economics/bake --input $input_file --output $output_file;;
  english-composition) $DIR/lib/recipes/english-composition/bake --input $input_file --output $output_file;;
  entrepreneurship) $DIR/lib/recipes/entrepreneurship/bake --input $input_file --output $output_file;;
  finance) $DIR/lib/recipes/finance/bake --input $input_file --output $output_file;;
  history) $DIR/lib/recipes/history/bake --input $input_file --output $output_file;;
  hs-physics) $DIR/lib/recipes/hs-physics/bake --input $input_file --output $output_file;;
  intro-business) $DIR/lib/recipes/intro-business/bake --input $input_file --output $output_file;;
  marketing) $DIR/lib/recipes/marketing/bake --input $input_file --output $output_file;;
  microbiology) $DIR/lib/recipes/microbiology/bake --input $input_file --output $output_file;;
  nursing-external) $DIR/lib/recipes/nursing-external/bake --input $input_file --output $output_file;;
  nursing-internal) $DIR/lib/recipes/nursing-internal/bake --input $input_file --output $output_file;;
  organic-chemistry) $DIR/lib/recipes/organic-chemistry/bake --input $input_file --output $output_file;;
  otto-book) $DIR/lib/recipes/chemistry/bake --input $input_file --output $output_file;;
  philosophy) $DIR/lib/recipes/philosophy/bake --input $input_file --output $output_file;;
  pl-economics) $DIR/lib/recipes/pl-economics/bake --input $input_file --output $output_file;;
  pl-psychology) $DIR/lib/recipes/pl-psychology/bake --input $input_file --output $output_file;;
  pl-u-physics) $DIR/lib/recipes/pl-u-physics/bake --input $input_file --output $output_file;;
  political-science) $DIR/lib/recipes/political-science/bake --input $input_file --output $output_file;;
  precalculus) $DIR/lib/recipes/precalculus/bake --input $input_file --output $output_file;;
  precalculus-coreq) $DIR/lib/recipes/precalculus-coreq/bake --input $input_file --output $output_file;;
  principles-management) $DIR/lib/recipes/principles-management/bake --input $input_file --output $output_file;;
  psychology) $DIR/lib/recipes/psychology/bake --input $input_file --output $output_file;;
  python) $DIR/lib/recipes/python/bake --input $input_file --output $output_file;;
  sociology) $DIR/lib/recipes/sociology/bake --input $input_file --output $output_file;;
  statistics) $DIR/lib/recipes/statistics/bake --input $input_file --output $output_file;;
  u-physics) $DIR/lib/recipes/u-physics/bake --input $input_file --output $output_file;;
  world-history) $DIR/lib/recipes/world-history/bake --input $input_file --output $output_file;;
  *) echo "Unknown book '${book}'"; exit 1;;
esac
