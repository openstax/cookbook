#!/usr/bin/env bash

DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" >/dev/null 2>&1 && pwd )"

usage="bake -b <bookname> -i <inputfile> -o <outputfile> -r <resourcedir>"

# Get command line arguments

while getopts b:i:o:r:h flag
do
  case "${flag}" in
    b) book=${OPTARG} ;;
    i) input_file=${OPTARG} ;;
    o) output_file=${OPTARG} ;;
    r) resource_dir=${OPTARG} ;;
    h) echo $usage; exit 0 ;;
    *) echo "Unknown flag '${flag}'"; exit 1 ;;
  esac
done

# Call the baking script based on the book.

DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" >/dev/null 2>&1 && pwd )"

# Bake with or without resources
if [ $NO_IMAGE_RESOURCES ]; then
  $DIR/lib/recipes/bake --input $input_file --output $output_file --recipe $book
else
  $DIR/lib/recipes/bake --input $input_file --output $output_file --recipe $book --resources $resource_dir
fi
